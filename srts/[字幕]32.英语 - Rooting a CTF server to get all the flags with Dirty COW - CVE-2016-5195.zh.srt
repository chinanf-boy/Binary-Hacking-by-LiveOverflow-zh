1
00:00:00,110 --> 00:00:03,480
所以我在浏览Reddit和这个新的CTF
对于初学者来说。

2
00:00:03,479 --> 00:00:09,079
很明显我必须直接检查
直奔我最喜欢的类别，二进制开发

3
00:00:09,080 --> 00:00:10,080
东西。

4
00:00:10,080 --> 00:00:14,080
当然还有一个服务器可以连接
作为一个普通用户，当你利用

5
00:00:14,079 --> 00:00:18,129
将特权提升到
另一个获得秘密访问权的用户

6
00:00:18,130 --> 00:00:19,240
旗帜。

7
00:00:19,240 --> 00:00:23,810
但最大的挑战，我不能
找到禁止这样做的规则

8
00:00:23,810 --> 00:00:24,810
生根

9
00:00:24,810 --> 00:00:32,480
那我们就这么做吧。

10
00:00:32,480 --> 00:00:34,990
还记得我的脏母牛解释视频吗？

11
00:00:34,990 --> 00:00:40,030
让我们利用概念证明
我们在那里测试了它是否能用在这个上面

12
00:00:40,030 --> 00:00:41,030
服务器。

13
00:00:41,030 --> 00:00:44,370
所以我们可以简单地将这个代码复制到一个文件中
在tmp中编译它。

14
00:00:44,370 --> 00:00:49,180
测试是否可以覆盖
属于我们，不覆盖批评

15
00:00:49,180 --> 00:00:55,050
根拥有的文件，我们作为另一个挑战登录
用户在系统上，创建一个文件

16
00:00:55,050 --> 00:00:56,050
内容。

17
00:00:56,050 --> 00:01:00,850
然后我们回到第一个用户，执行
那个文件上的脏母牛并试图写

18
00:01:00,850 --> 00:01:02,790
还有其他一些角色。

19
00:01:02,790 --> 00:01:04,950
当我们检查的时候，我们可以看到它起作用了。

20
00:01:04,949 --> 00:01:09,849
这时我给作者写了一封信
在Reddit上通知他服务器

21
00:01:09,850 --> 00:01:12,070
易受攻击，他应该迅速更新。

22
00:01:12,070 --> 00:01:16,550
但是现在我们需要一个计划什么样的根文件我们可以
把自己改写成根。

23
00:01:16,550 --> 00:01:21,650
我们的限制是，我们必须重写
文件中的某些内容，无法追加或

24
00:01:21,650 --> 00:01:23,500
准备好任何东西。

25
00:01:23,500 --> 00:01:29,520
第一个明显的想法是setuid二进制，
但问题是为了写一个

26
00:01:29,520 --> 00:01:34,190
后门壳到二进制，我们会
解析ELF文件格式并找出

27
00:01:34,189 --> 00:01:36,549
入口点在哪里。

28
00:01:36,549 --> 00:01:40,589
更简单的策略是在
文本文件。

29
00:01:40,590 --> 00:01:43,280
我选择了/etc/passwd。

30
00:01:43,280 --> 00:01:48,200
您可以在这里看到用户的用户ID，
如果我们改变pwn1的uid

31
00:01:48,200 --> 00:01:51,280
用户为0时，我们将以根用户身份登录。

32
00:01:51,280 --> 00:01:52,280
所以。

33
00:01:52,280 --> 00:01:55,560
肮脏的奶牛概念证明写信给
文件的开头。

34
00:01:55,560 --> 00:01:58,560
所以我们首先要计算出偏移量
在/etc/passwd内部。

35
00:01:58,560 --> 00:02:02,160
我们可以用hexdump来计算一下
比特。

36
00:02:02,159 --> 00:02:06,839
所以pwn1用户处于偏移量hex 4c0加上一点
比特。

37
00:02:06,840 --> 00:02:12,970
我使用python作为calucator并修改
利用代码写入固定偏移量。

38
00:02:12,970 --> 00:02:14,960
我认为这是个好计划。

39
00:02:14,959 --> 00:02:20,089
你必须非常小心
选择这些偏移量并选择要做什么

40
00:02:20,091 --> 00:02:23,951
写，因为你可以把整个事情搞砸
系统，如果你没有。

41
00:02:23,950 --> 00:02:30,150
所以我复制/etc/passwd来尝试我想要的
在对真正的二进制文件执行此操作之前先执行此操作。

42
00:02:30,150 --> 00:02:33,730
当然，我的第一次尝试
破坏了系统。

43
00:02:33,730 --> 00:02:40,670
所以调整一点偏移量，同时附加
最后一条新线终于成功了

44
00:02:40,670 --> 00:02:43,360
我写信给真正的/etc/passwd。

45
00:02:43,360 --> 00:02:47,870
现在，当我们切换到pwn1或ssh时，登录到
pwn1，我们得到一个根壳。

46
00:02:47,870 --> 00:02:51,770
然后我们可以读出所有的标记。

47
00:02:51,770 --> 00:02:57,290
完成后，我们返回/etc/passwd
到原始状态。

48
00:02:57,290 --> 00:02:58,550
一些重要的注释。

49
00:02:58,550 --> 00:03:01,930
非常小心用什么覆盖
像这样的剥削。

50
00:03:01,930 --> 00:03:08,730
只有一个字节计算错误，您可能
使系统不稳定、崩溃或简单地

51
00:03:08,730 --> 00:03:10,400
把自己锁在外面。

52
00:03:10,400 --> 00:03:15,590
另外，如果您发现服务器易受攻击，请考虑
关于你所处的影响或背景。

53
00:03:15,590 --> 00:03:21,070
这个小型的私人CTF服务器项目，
旨在锤击的不同于

54
00:03:21,069 --> 00:03:23,789
一个你随机利用的网络服务器
公司。

55
00:03:23,790 --> 00:03:27,950
所以，如果有的话，不要到处尝试这个。
没有权限，否则会导致

56
00:03:27,950 --> 00:03:30,400
损坏。

57
00:03:30,400 --> 00:03:32,210
做出合乎道德的决定。

58
00:03:32,209 --> 00:03:34,519
注意你所冒的风险。

59
00:03:34,519 --> 00:03:39,239
感谢Maro对此事的冷静
并允许我制作一个关于它的视频。

60
00:03:39,239 --> 00:03:40,299
祝你的鸭嘴兽好运。

